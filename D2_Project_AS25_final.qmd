---
title: "D2 DoE project AS 2025"
author: "Viviane Werlen, Yannik Ezekwu, Elia Salerno"                       
format: 
  pdf:
    papersize: A4
    mainfont: "Arial"
    embed-resources: true
    # self-contained-math: true
    # toc: true
    # toc_float: true
    # number_sections: true
    # fig-width: 8
    # fig-height: 4
# If producing the pdf does not work: do not try a too long time, but
# delete the above "pdf" section, and un-comment the relevant lines:
  # html:
  #   embed-resources: true
  #   self-contained-math: true
  #   toc: true
  #   toc_float: true
  #   number_sections: true
  #   fig-width: 8
  #   fig-height: 4
editor: visual
editor_options: 
  chunk_output_type: console
  # canonical: true
execute: 
  warning: false
  message: false
---

## D2 DoE Project AS 2025: Tasks & Answers

#### Preliminaries

For this project you will perform **your own small scale experiment**. You will have to choose an interesting response variable that you can easily measure, define multiple explanatory variables and plan an experiment. After doing the experiment, you will proceed to analyze your results and provide an accurate presentation of the results and your conclusions.

This file contains your tasks, as well as fields where you should put your answers. Please edit this .qmd file and render it as pdf afterwards. Upload the pdf on the moodle, as well as your collected data (.xlsx or .csv).\
**Deadline for the project is December 12th, 9 am**.

You do the project as **small groups of 2-4 persons**, as defined by the breakout rooms of the Teams session today. If you have problems finding a group or working together, please contact [Stefanie Feiler](mailto:stefanie.feiler@fhnw.ch) as soon as possible.

Before you start with the project, also make sure that you have added your names in the "author" part above.

Note that we do *not* judge whether your experiments as such were successful, only whether you did your data analysis well and whether your answers are consistent. **If your model is not satisfying in the end, this does not matter** - as long as you comment on it correctly.

If you have questions, **feel free to ask** the lecturers and/or your local coaches.

#### Step 1: Project definition

You should choose a project which does not cost you too much time. The requirements are that you find some activity that

-   All of you can do, with at least 3 complete repetitions per person

-   Allows you to measure some quantitative outcome

-   You can also repeat under different conditions.

Examples are

-   Doing sports (running up stairs, do push-ups, ...)

-   Simple cooking (microwave popcorn, tea, drinks, ...)

-   Online tests (reaction, calculus, puzzles, ...)

-   ...

We are sure that you will find something and are looking forward to your ideas!

[**This is our research question:**]{style="color: green;"}

::: {style="color: green;"}
Does the WiFi download speed depend on the device type, the location (home vs. uni), and the distance to the router?
:::

#### Step 2: Planning

1.  Pretend that this is a real large project:\
    Think about 10 different explanatory variables (= "influence factors") which may influence your outcome. We don't mind you getting creative ("wearing a hat: yes/no", ...).\
    Please note: when the word "factor" is used this report, it does *not* define the data type of R. In DoE, it is another word for "input variable".

    1.  Narrow down the possibilities until you have decided on

        -   one quantitative (numerical) outcome

        -   (at least) two influence factors (quantitative or discrete)

        -   and the third influence factor is the person who performs the experiment, i.e. the persons of your small group.

        *This is only the compromise for feasibility in the course. In a real project, starting with ten factors is fine â€” you can test them all, as long as you do the thinking before the doing.*

For instance, you could decide to measure the time needed for doing a certain number of calculations with an online-tool (e.g., [http://sikore.schiffner-tischer.de/](http://sikore.schiffner-tischer.de/index_en.html){.uri}), or an online reaction test, typing with your dominant / non-dominant hand, in the morning and evening.

However, exactly that last option is forbidden, as well as using the website *humanbenchmark.com* - otherwise we'll get too many too similar projects and that will be boring ;)

Document your process:

[**This picture shows our brainstorming results**]{style="color: green;"} (mindmap, Ishikawa diagram, ...):

::: {style="color: green;"}
![](images/clipboard-1825956897.png)
:::

[**These is what we have decided on:**]{style="color: green;"}

[**Outcome:**]{style="color: green;"}

::: {style="color: green;"}
Download speed (Mbps)
:::

[**... measured in this way:**]{style="color: green;"}

::: {style="color: green;"}
Using the speedtest.net online tool (taking the download speed result at the end of the test, which is based on a modified trimean built from 10th percentile, 50th percentile (median), and 90th percentile in a 1:8:1 ratio, source: <https://www.ookla.com/resources/guides/speedtest-methodology#performance-metrics>)
:::

[**Our remaining influence factors are:**]{style="color: green;"}

+--------------+-----------------------------+-----------------------------+-----------------------------+
|              | Name                        | Range / levels              | factor type:\               |
|              |                             |                             | random or fixed?            |
+==============+=============================+=============================+=============================+
| **Factor 1** | ::: {style="color: green;"} | ::: {style="color: green;"} | ::: {style="color: green;"} |
|              | Device                      | Phone, Laptop               | Fixed                       |
|              | :::                         | :::                         | :::                         |
+--------------+-----------------------------+-----------------------------+-----------------------------+
| **Factor 2** | ::: {style="color: green;"} | ::: {style="color: green;"} | ::: {style="color: green;"} |
|              | Location                    | Home, Uni                   | Fixed                       |
|              | :::                         | :::                         | :::                         |
+--------------+-----------------------------+-----------------------------+-----------------------------+
| **Factor 3** | ::: {style="color: green;"} | ::: {style="color: green;"} | ::: {style="color: green;"} |
|              | Approx. distance to Router  | 1m, 5m, 10m                 | Fixed                       |
|              | :::                         | :::                         | :::                         |
+--------------+-----------------------------+-----------------------------+-----------------------------+
| **Factor 4** | Persons (of your group)     | ::: {style="color: green;"} | ::: {style="color: green;"} |
|              |                             | Elia, Yannik, Viviane       | Random                      |
|              |                             | :::                         | :::                         |
+--------------+-----------------------------+-----------------------------+-----------------------------+
| **Factor 5** | Daytime                     | ::: {style="color: green;"} | ::: {style="color: green;"} |
|              |                             | Any, HH:MM:SS               | Random                      |
|              |                             | :::                         | :::                         |
+--------------+-----------------------------+-----------------------------+-----------------------------+

#### Step 3: Experimental Setup

[**We are going to proceed as follows:**]{style="color: green;"}

::: {style="color: green;"}
Each group member measures the download speed at two locations (Home, Uni). At each location, measurements are taken with two devices (Phone, Laptop) at varying distances (1m, 5m, 10m) from the router.
:::

Do you need to randomize the order of your runs?

::: {style="color: green;"}
Yes. Run order was randomized for each person to minimize the effect of temporary network fluctuations
:::

Is there anything else to consider?

::: {style="color: green;"}
'Person' is treated as a blocking factor (Random effect) to account for different baseline internet speeds at our respective homes.
:::

Is there anything which is not ideal in terms of experimentation, but where you did not find a better solution?

::: {style="color: green;"}
Exact distance to the router was an estimate (Line-of-Sight) due to physical constraints at the University. Walls and ceilings could pose additional various obstacles.
:::

#### Step 4: Experiments!

Do your experiments, and collect your data. Remecmber that it is obligatory to do **at least 3 replicates** per person and factor combination.

Do not forget to [upload the data](https://mslscommunitycentre.ch/course/section.php?id=3334) as .xslx or .csv on the moodle.

[**This is a fun picture showing how we did the experiments:**]{style="color: green;"}

::: {style="color: green;"}
![](images/clipboard-4285947568.png)
:::

Are there any remarks you'd like to add with respect to the experimentation step?

::: {style="color: green;"}
Some measurements at the university varied highly due to high variance in the network load.
:::

#### Step 5: Data analysis

We strongly recommend that **each of your group does this part** separately - then meet up, exchange your approaches, compare the results, decide on the best plots, and on what to enter into the report.\
Only by actually *doing* these tasks you'll see whether you have mastered this part of the course content.

[**Here is the R code used for the analysis:**]{style="color: green;"}

Entering the data into R:

::: {style="color: green;"}
```{r data}
library(lme4)
library(effects)
library(car)

df <- read.csv("d2_doe_data.csv")

df$person <- as.factor(df$person)
df$device <- as.factor(df$device)
df$location <- as.factor(df$location)
df$approx_distance_router_meters <- as.factor(df$approx_distance_router_meters)
df$time <- as.factor(df$time)

head(df)
```
:::

**This plot shows our data:**

::: {style="color: green;"}
```{r plot}
boxplot(download_speed_mbit_result ~ device, data = df,
        main = "Download-Speed ~ Device",
        xlab = "Device", ylab = "Speed (Mbit/s)", col="lightblue")

boxplot(download_speed_mbit_result ~ location, data = df,
        main = "Download-Speed ~ Location",
        xlab = "Location", ylab = "Speed (Mbit/s)", col="lightgreen")

boxplot(download_speed_mbit_result ~ approx_distance_router_meters, data = df,
        main = "Download-Speed ~ Distance",
        xlab = "Distance (m)", ylab = "Speed (Mbit/s)", col="lightcoral")

```
:::

**Now we calculate the model and check for significance factors by Anova:**

::: {style="color: green;"}
```{r}
model_initial <- lmer(
  download_speed_mbit_result ~ device + location + approx_distance_router_meters +
    (1 | person) + (1 | time),
  data = df
)

summary(model_initial)

Anova(model_initial)
```

The inclusion of the time factor is not statistically meaningful, as almost every measurement point occurs only once and there is therefore no real replication. This makes time in the model an overpowering random effect that absorbs almost all of the variation and leads to an artificially low residual variance. This complicates the interpretation of the main effects and leads to an unstable variance estimate. A model without time is therefore better.

```{r}
model <- lmer(
  download_speed_mbit_result ~ device + location + approx_distance_router_meters +
    (1 | person),
  data = df
)

summary(model)

Anova(model)
```
:::

**These are the model diagnostics**, i.e. how we have checked for the assumptions:

::: {style="color: green;"}
```{r}
res <- residuals(model)
fitted_vals <- fitted(model)

par(mfrow = c(1, 2))

qqnorm(res, main = "Q-Q Plot")
qqline(res, col = "red")

plot(fitted_vals, res,
     main = "Residuals vs Fitted",
     xlab = "Fitted Values",
     ylab = "Residuals")
abline(h = 0, col = "red")

par(mfrow = c(1, 1))

shapiro.test(res)
```
:::

**This is a plot which visualizes the model we have found:**

::: {style="color: green;"}
```{r fig.width=10, fig.height=6, dpi=150}
plot(allEffects(model), main = "Main Effects Plot", grid = TRUE)

```
:::

[**Our conclusions on the model reliability are:**]{style="color: green;"}

::: {style="color: green;"}
The model diagnostics confirm that the assumptions for linear mixed models are adequately met. The Q-Q plot shows that residuals are approximately normally distributed, with points lying close to the theoretical line. The residuals vs. fitted values plot shows no systematic patterns or funnel shape, indicating homoscedasticity (constant variance). The random effect for Person accounts for individual differences in baseline internet speeds across homes. Note: The time factor was initially included but removed from the final model as it showed negligible variance and caused model instability, indicating no meaningful temporal blocking effect in our data. The final model shows a singular fit for the person random effect, suggesting that baseline speeds across our three homes were more similar than anticipated, but this does not affect the validity of our fixed effect conclusions.
:::

[**Altogether we have found out that:**]{style="color: green;"}

::: {style="color: green;"}
Distance to the router is the strongest influence factor: moving from 1m to 5m drops speed by \~339 Mbps, and to 10m by \~587 Mbps. Device is also significant, with phones being slower (\~161 Mbps less) than laptops. Location was weakly significant (p=0.037), while Person did not have a statistically significant impact on the speed in our model.
:::

#### Step 6: Final Comments

::: {style="color: green;"}
```{r}
model_interaction <- lmer(
  download_speed_mbit_result ~ device * approx_distance_router_meters + location +
    (1 | person),
  data = df
)
anova(model, model_interaction)
```
:::

[**This is what we can say about interactions in the data:**]{style="color: green;"}

::: {style="color: green;"}
The interaction model shows a statistically significant improvement over the main effects model (p = 0.003). This suggests that the effect of distance on download speed differs between phones and laptops. Specifically, the speed degradation with increasing distance appears more pronounced for one device type than the other. However, given the complexity this adds to interpretation and the relatively modest improvement in model fit, the main effects model remains our primary focus for practical conclusions.
:::

Is there anything else you want to add, e.g.,

-   What you would do differently next time?

-   What you have learnt in this project which surprised you?

-   ...

::: {style="color: green;"}
Next time, we would measure the distances to the router more precisely (e.g. using a tape measure) rather than estimating. We were surprised that the speed drop-off at 10m was so drastic (over 70% loss) compared to 1m.
:::

#### Step 7: Report

Render the .qmd file (the "render" button with the large arrow at the top of the qmd file editor in RStudio) in order to obtain a **pdf** and [upload it](https://mslscommunitycentre.ch/course/section.php?id=3334), together with your data (as .xlsx or .csv file), on the moodle.

For rendering the file, you need the packages *rmarkdown* and for the pdf generation some latex installation like e.g. [*tinytex*](https://yihui.org/tinytex/). These can be installed by

-   running these commands below in RStudio:\
    `install.packages("rmarkdown")`\
    `install.packages("tinytex")`\
    `tinytex::install_tinytex()`

-   or via the terminal in RStudio as shown in this [short video](https://www.youtube.com/watch?v=OUWOx80eJqk).

Of course, neither your RStudio nor your R version should be too old versions.

The installation should be easy. However, if your group does not manage to generate the pdf, please stop before you get too frustrated. In this case, edit the header of this document such that it produces an html file, which you then can print to pdf - if the layout is not optimal, it does not matter that much. Nevertheless: producing nice markdown documents is very satisfying, so give it a try!

Please also submit a post with your research question, a nice picture, and comments on your experiences to this [Padlet](https://padlet.com/stefaniefeiler/D2_DoE_AS2025) - we would like that the other groups can see and admire your work. It's anonymous, so no need to be embarrassed.

\newpage

#### Grading

For this report, there are 0.5 points per item below, i.e. 4 points altogether:

+-----------------------------------+--------------+---------------------+----------------------+
| Item                              | OK           | something's missing | not answered / wrong |
+===================================+==============+=====================+======================+
| research question, outcome &\     |              |                     |                      |
| measuring it                      |              |                     |                      |
+-----------------------------------+--------------+---------------------+----------------------+
| picture of brainstorming results  |              |                     |                      |
+-----------------------------------+--------------+---------------------+----------------------+
| factors                           |              |                     |                      |
+-----------------------------------+--------------+---------------------+----------------------+
| experimental setup & data\        |              |                     |                      |
| collection, picture               |              |                     |                      |
+-----------------------------------+--------------+---------------------+----------------------+
| analysis in R: plot, model\       |              |                     |                      |
| (consistent with your planning)   |              |                     |                      |
+-----------------------------------+--------------+---------------------+----------------------+
| analysis in R: plot of results &\ |              |                     |                      |
| stating the findings              |              |                     |                      |
+-----------------------------------+--------------+---------------------+----------------------+
| model diagnostics\                |              |                     |                      |
| (R and comments)                  |              |                     |                      |
+-----------------------------------+--------------+---------------------+----------------------+
| interactions                      |              |                     |                      |
+-----------------------------------+--------------+---------------------+----------------------+

This means that the final grade is combined of these 4 points, 4 points for attendance, and 32 points in the exam.
